@using System.Reflection
@using Siren.Components.RequestContextPanel.Authentication
@using Mythetech.Components.Components.SimpleTabs
<SirenStack Class="h-100 w-100">
    <SirenStack Row="true" Class="w-100">
        <MudPaper Elevation="0" Square="true" Width="calc(100% - 3.5rem)" Class="flex-shrink-1 py-2 h-100 w-100">
            <SimpleTabs>
                <Tab Name="Auth" Icon="@SirenIcons.Auth">
                    <ChildContent>
                        <AuthenticationPanel />
                    </ChildContent>
                </Tab>
                <Tab Name="Headers" Icon="@SirenIcons.Headers">
                    <ChildContent>
                        <HeadersPanel />
                    </ChildContent>
                </Tab>
                <Tab Name="Cookies" Icon="@SirenIcons.Cookies">
                    <ChildContent>
                        <CookiePanel />
                    </ChildContent>
                </Tab>
            </SimpleTabs>
        </MudPaper>
    </SirenStack>
    @if(string.IsNullOrWhiteSpace(_openTab))
    {
        <SirenStack AlignItems="AlignItems.Center" Justify="Justify.Center">
            <SirenText>No panel selected</SirenText>
        </SirenStack>
    }
</SirenStack>
@code {
    [Inject]
    SirenAppState AppState { get; set; }

    [Parameter]
    public EventCallback PanelClosed { get; set; } = default!;

    [Parameter]
    public bool IsOpen { get; set; } = false;

    private MudToggleGroup<string> _toggle;

    private Dictionary<string, int> TabLookup = new()
    {
        {"Auth", 0 },
        { "Headers", 1 },
        {"Cookies", 2 }
    };

    private string _openTab = "";

    public async Task Open(string tab)
    {
        _openTab = tab;

        /*
        _toggle.Value = _openTab;
        _toggle.GetType().GetMethod("OnValueChanged", BindingFlags.NonPublic | BindingFlags.Instance).Invoke(_toggle, default);

        await _toggle.ValueChanged.InvokeAsync(tab);
        */

        StateHasChanged();
    }
}

