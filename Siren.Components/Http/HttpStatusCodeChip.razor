@using System.Net

<MudTooltip Arrow="true" Placement="Placement.Bottom">
    <ChildContent>
        <div class="siren-metric-chip @GetChipClass()">
            <span class="siren-status-code">@GetStatusCodeText()</span>
        </div>
    </ChildContent>
    <TooltipContent>
        <div class="siren-tooltip-panel siren-tooltip-panel--status">
            <div class="siren-status-detail">
                <span class="siren-status-badge @GetBadgeClass()">@((int)StatusCode)</span>
                <span class="siren-status-name">@GetStatusName()</span>
            </div>
            <div class="siren-status-category">@GetCategoryDescription()</div>
        </div>
    </TooltipContent>
</MudTooltip>

@code {
    [Parameter]
    public bool IsDarkMode { get; set; }

    [Parameter]
    public HttpStatusCode StatusCode { get; set; }

    private string GetStatusCodeText()
    {
        var code = (int)StatusCode;
        return code == 0 ? "---" : code.ToString();
    }

    private string GetStatusName()
    {
        var code = (int)StatusCode;
        if (code == 0) return "Cancelled";
        return StatusCode.ToString().Replace("([a-z])([A-Z])", "$1 $2");
    }

    private string GetChipClass()
    {
        var code = (int)StatusCode;
        return code switch
        {
            0 => "siren-metric-chip--status-cancelled",
            >= 200 and < 300 => "siren-metric-chip--status-success",
            >= 300 and < 400 => "siren-metric-chip--status-redirect",
            >= 400 and < 500 => "siren-metric-chip--status-client-error",
            >= 500 => "siren-metric-chip--status-server-error",
            _ => "siren-metric-chip--status-default"
        };
    }

    private string GetBadgeClass()
    {
        var code = (int)StatusCode;
        return code switch
        {
            0 => "siren-status-badge--cancelled",
            >= 200 and < 300 => "siren-status-badge--success",
            >= 300 and < 400 => "siren-status-badge--redirect",
            >= 400 and < 500 => "siren-status-badge--client-error",
            >= 500 => "siren-status-badge--server-error",
            _ => "siren-status-badge--default"
        };
    }

    private string GetCategoryDescription()
    {
        var code = (int)StatusCode;
        return code switch
        {
            0 => "Request was cancelled",
            >= 100 and < 200 => "Informational response",
            >= 200 and < 300 => "Successful response",
            >= 300 and < 400 => "Redirection message",
            >= 400 and < 500 => "Client error response",
            >= 500 => "Server error response",
            _ => "Unknown status"
        };
    }
}
